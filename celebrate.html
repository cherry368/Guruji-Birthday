<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Celebrate Guruji!</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    :root{ --bg1:#071224; --bg2:#081827; --accent:#ffc600; --accent2:#ff59b9; --muted:#dbe7f3 }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--muted);display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{max-width:1100px;width:100%;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:28px;box-shadow:0 20px 60px rgba(2,6,23,0.6);}
    h1{margin:0 0 8px 0;font-size:1.6rem;text-align:center;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .section-title{color:var(--muted);text-align:center;margin:6px 0 18px 0}

    /* balloon stage */
    .balloon-stage{position:relative;height:420px;border-radius:12px;overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(0,0,0,0.06));margin:0 auto 16px;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02)}
    .balloon{position:absolute;bottom:-160px;width:92px;height:120px;border-radius:50% 50% 46% 46%;display:flex;align-items:flex-start;justify-content:center;transform-origin:center 70%;cursor:pointer;box-shadow:0 10px 28px rgba(2,6,23,0.6);transition:transform .18s ease,opacity .4s ease}
    .balloon .knot{position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);width:14px;height:10px;border-radius:2px}
    .balloon .string{position:absolute;bottom:-190px;left:50%;transform:translateX(-50%);width:2px;height:5000px;background:linear-gradient(#ffffff11,#ffffff00)}

    .controls{display:flex;gap:12px;justify-content:center;margin-top:12px}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#061124;border:none;padding:0.9rem 1.6rem;border-radius:999px;font-weight:700;cursor:pointer}

    /* cake area (hidden until balloons complete + user clicks "Let's cut the cake") */
    .cake-wrap{display:none;margin-top:20px;align-items:center;justify-content:center;flex-direction:column}
    .cake-stage{display:flex;gap:24px;align-items:center;justify-content:center;flex-direction:column}
    .plate{width:420px;height:60px;border-radius:50%;background:radial-gradient(circle at 50% 30%, #fff, #f4f4f4);box-shadow:0 10px 30px rgba(2,6,23,0.5);display:flex;align-items:center;justify-content:center;position:relative}
    .cake{width:360px;border-radius:12px;background:linear-gradient(180deg,#fff8f2,#ffd9c5);position:relative;padding-bottom:28px;box-shadow:0 18px 40px rgba(2,6,23,0.6)}
    .layer{height:48px;margin:6px 18px;border-radius:8px;background:linear-gradient(180deg,#ffe7d0,#ffd6bc);box-shadow:inset 0 2px 0 rgba(255,255,255,0.3)}
    .cream{height:6px;margin:0 12px;background:linear-gradient(180deg,#fff,#f7e6d8);border-radius:4px;box-shadow:0 1px 0 rgba(255,255,255,0.5) inset}
    .candles{position:absolute;top:-6px;left:50%;transform:translateX(-50%);display:flex;gap:10px}
    .candle{width:8px;height:34px;border-radius:3px;position:relative;display:block}
    .flame{position:absolute;top:-14px;left:50%;transform:translateX(-50%);width:10px;height:12px;border-radius:50%;background:radial-gradient(circle at 40% 30%, #ffd86b,#ff8a00)}
    .slice{position:absolute;right:22px;bottom:0;width:96px;height:118px;background:linear-gradient(180deg,#fff4ea,#ffe6cc);border-radius:8px;transform-origin:left bottom;transition:transform .9s cubic-bezier(.2,.9,.2,1), opacity .5s;box-shadow:0 12px 26px rgba(2,6,23,0.45)}
    .slice.cut{transform: translateX(260px) rotate(-28deg) scale(.98); opacity:0.98}

    .knife{width:200px;height:18px;background:linear-gradient(90deg,#cfd6db,#98a3aa);border-radius:10px;position:relative;transform-origin:left center;box-shadow:0 8px 18px rgba(2,6,23,0.5);display:flex;align-items:center;justify-content:center;cursor:pointer}
    .knife .handle{width:46px;height:18px;border-radius:6px;background:linear-gradient(90deg,#6b8eff,#2f5bd9);position:absolute;right:-56px;top:0;box-shadow:0 6px 12px rgba(0,0,0,0.4)}
    .knife .blade-tip{width:10px;height:14px;background:linear-gradient(180deg,#fff,#cfd6db);position:absolute;left:8px;border-radius:2px}

    .note{margin-top:18px;color:#fff7d6;font-weight:700;display:none;font-size:1.05rem;text-align:center}
    .next-cta{margin-top:14px;display:none}

    .cut-btn{display:none;margin:0 auto 12px auto}

    #confettiCanvas{position:fixed;left:0;top:0;pointer-events:none;width:100%;height:100%;z-index:9999}
    @media(max-width:720px){.plate{width:300px}.cake{width:260px}.knife{width:150px}.slice{width:72px;height:92px}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Balloon Blasting & Cake Cutting</h1>
    <p class="section-title" id="stageTitle">Pop all the balloons to reveal the cake üéà</p>

    <div id="balloonStage" class="balloon-stage" aria-label="Balloon stage"></div>

    <!-- Removed the reset button as requested. We'll show a "Let's cut the cake" button after balloons done. -->
    <div class="controls" id="controls">
      <!-- placeholder for future controls -->
    </div>

    <!-- cut button appears after balloons completed -->
    <div style="text-align:center">
      <button class="btn cut-btn" id="cutBtn">Let's cut the cake üéÇ</button>
    </div>

    <div class="cake-wrap" id="cakeWrap" aria-hidden="true">
      <div class="cake-stage">
        <p class="section-title">Cake Cutting ‚Äî click the slice to cut the cake</p>

        <div class="plate" aria-hidden="true">
          <div class="cake" id="cake">
            <div class="candles">
              <div class="candle" style="background:#ff6b6b"><div class="flame"></div></div>
              <div class="candle" style="background:#6b8eff"><div class="flame"></div></div>
              <div class="candle" style="background:#ffd86b"><div class="flame"></div></div>
            </div>

            <div class="layer"></div>
            <div class="cream"></div>
            <div class="layer"></div>
            <div class="cream"></div>
            <div class="layer"></div>

            <div class="slice" id="slice" title="Click to cut the cake"></div>
          </div>
        </div>

        <div style="display:flex;gap:12px;align-items:center;justify-content:center;margin-top:8px;">
          <div class="knife" id="knife" title="Click me to slice">
            <div class="blade-tip"></div>
            <div class="handle"></div>
          </div>
        </div>

        <p class="note" id="cakeNote">Yahhh ‚Äî it‚Äôs time to eat cake! Make sure you save me a slice too üç∞</p>
        <div class="next-cta" id="nextCta">
          <button id="nextBtn" class="btn">Let's see what's next</button>
        </div>
      </div>
    </div>
  </div>

  <canvas id="confettiCanvas"></canvas>

  <script>
  (function(){
    // Config
    const BALLOON_COUNT = 4;
    const SIZE_MIN = 56; const SIZE_MAX = 110; const MAX_RISE_RATIO = 0.55; const SPEED_MIN = 0.6; const SPEED_MAX = 1.6;

    // DOM
    const stage = document.getElementById('balloonStage');
    const confettiCanvas = document.getElementById('confettiCanvas');
    const ctx = confettiCanvas.getContext && confettiCanvas.getContext('2d');
    const cutBtn = document.getElementById('cutBtn');
    const cakeWrap = document.getElementById('cakeWrap');
    const slice = document.getElementById('slice');
    const knife = document.getElementById('knife');
    const cakeNote = document.getElementById('cakeNote');
    const nextCta = document.getElementById('nextCta');
    const nextBtn = document.getElementById('nextBtn');

    let rafId = null, popped = 0, balloons = [], knifeArmed = false, cakeCut = false;

    function resizeCanvas(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight; }
    resizeCanvas(); window.addEventListener('resize', resizeCanvas);
    function rand(min,max){ return Math.random()*(max-min)+min; }

    function popAt(x,y,count=30){ if(!ctx) return; const pieces=[]; for(let i=0;i<count;i++){ pieces.push({ x,y, vx:(Math.random()-0.5)*8, vy:(Math.random()*-6)-1, size:6+Math.random()*8, color:['#FF9AA2','#FFB7B2','#FFDAC1','#B5EAD7','#C7CEEA','#F6B352'][Math.floor(Math.random()*6)], rot:Math.random()*360, dr:(Math.random()-0.5)*10, life: 90 + Math.floor(Math.random()*80) }) } (function frame(){ ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); for(let p of pieces){ p.x += p.vx; p.y += p.vy; p.vy += 0.18; p.rot += p.dr; p.life--; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180); ctx.fillStyle = p.color; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6); ctx.restore(); } for(let i=pieces.length-1;i>=0;i--) if(pieces[i].life<=0) pieces.splice(i,1); if(pieces.length>0) requestAnimationFrame(frame); })(); }

    function createBalloons(){ cancelAnimationFrame(rafId); stage.innerHTML=''; balloons=[]; popped=0; const rect = stage.getBoundingClientRect(); const stageHeight = rect.height; const maxUp = Math.max(80, Math.round(stageHeight * MAX_RISE_RATIO)); for(let i=0;i<BALLOON_COUNT;i++){ const b = document.createElement('div'); b.className='balloon'; const left = 4 + Math.random()*92; b.style.left = left + '%'; const size = Math.round(rand(SIZE_MIN, SIZE_MAX)); b.style.width = size + 'px'; b.style.height = Math.round(size * 1.2) + 'px'; const colorPal = [ ['#FF9AA2','#FF6B6B'],['#A0C4FF','#6B8EFF'],['#FFD6A5','#FFB86B'],['#C9F9D5','#52E5A6'],['#FBC2EB','#A18CD1'],['#FFE29F','#FFAD66'] ]; const c = colorPal[i % colorPal.length]; b.style.background = `linear-gradient(180deg, ${c[0]}, ${c[1]})`; const knot = document.createElement('div'); knot.className='knot'; knot.style.background = c[1]; knot.style.width = '14px'; knot.style.height='10px'; knot.style.position='absolute'; knot.style.bottom='-10px'; knot.style.left='50%'; knot.style.transform='translateX(-50%)'; knot.style.borderRadius='2px'; const string = document.createElement('div'); string.className='string'; string.style.position='absolute'; string.style.bottom='-190px'; string.style.left='50%'; string.style.transform='translateX(-50%)'; string.style.width='2px'; string.style.height='180px'; string.style.background='linear-gradient(#ffffff11,#ffffff00)'; b.appendChild(knot); b.appendChild(string); b._y = 0; b._dir = -1; b._speed = rand(SPEED_MIN, SPEED_MAX); b._maxUp = maxUp; b._popped = false; b.addEventListener('click', (ev)=>{ if(b._popped) return; b._popped = true; b.classList.add('popped'); popped++; popAt(ev.clientX, ev.clientY, 36); b.style.transform = `translateY(${b._y}px) scale(0.18) rotate(${Math.round(rand(18,40))}deg)`; b.style.opacity = '0'; setTimeout(()=>{ if(b.parentNode) b.parentNode.removeChild(b); }, 420); if(popped >= BALLOON_COUNT) finishBalloons(); }); stage.appendChild(b); balloons.push(b); } animateBalloons(); }

    function animateBalloons(){ function frame(){ for(let b of balloons){ if(b._popped) continue; b._y += b._dir * b._speed; if(b._y <= -b._maxUp){ b._y = -b._maxUp; b._dir = 1; } else if(b._y >= 0){ b._y = 0; b._dir = -1; b._speed = rand(SPEED_MIN, SPEED_MAX); } b.style.transform = `translateY(${b._y}px)`; if(!b._popped) b.style.opacity = '1'; } rafId = requestAnimationFrame(frame); } cancelAnimationFrame(rafId); rafId = requestAnimationFrame(frame); }

    function finishBalloons(){ // show cut button (do not show cake yet)
      cutBtn.style.display = 'inline-block'; document.getElementById('stageTitle').textContent = 'All balloons popped! Ready for cake?'; popAt(window.innerWidth/2, window.innerHeight/3, 120); }

    // when user clicks "Let's cut the cake" button -> hide balloons and show cake area
    cutBtn.addEventListener('click', ()=>{
      // hide balloons stage and controls to focus on cake
      stage.style.display = 'none'; document.getElementById('controls').style.display = 'none'; cutBtn.style.display = 'none';
      cakeWrap.style.display = 'flex'; cakeWrap.setAttribute('aria-hidden','false');
      document.getElementById('stageTitle').textContent = 'Cake is here ‚Äî click the slice to cut it';
    });

    // knife arming visual (optional)
    knife.addEventListener('click', ()=>{ if(cakeCut) return; knife.classList.add('armed'); knife.style.transform = 'translateY(-6px) rotate(-4deg)'; setTimeout(()=>knife.style.transform='',250); });

    // slice click to cut and split into piece
    slice.addEventListener('click', (ev)=>{
      if(cakeCut) return; cakeCut = true; // animate slice out
      slice.classList.add('cut'); popAt(window.innerWidth/2, window.innerHeight/2, 180);
      // show note and next CTA after cut animation
      setTimeout(()=>{ cakeNote.style.display = 'block'; nextCta.style.display = 'block'; }, 700);
    });

    // next button -> go to audio (or whatever you want)
    nextBtn.addEventListener('click', ()=>{ window.location.href = 'audio.html'; });

    // start
    createBalloons();
  })();
  </script>
</body>
</html>
